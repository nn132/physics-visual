<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AIåŠ©æ‰‹æµ‹è¯•é¡µé¢</title>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <!-- KaTeX for LaTeX math rendering -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <!-- AIåŠ©æ‰‹æ ·å¼ -->
  <link rel="stylesheet" href="ai-assistant.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .test-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    .test-section {
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    .test-section h2 {
      color: #667eea;
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 18px;
    }
    .test-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    .test-button:hover {
      opacity: 0.9;
    }
    .code-block {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', Courier, monospace;
      font-size: 13px;
      margin-top: 10px;
    }
    .info {
      background: #e6f2ff;
      border-left: 4px solid #667eea;
      padding: 12px;
      margin: 10px 0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>ğŸ§ª AIåŠ©æ‰‹ Markdown & LaTeX æµ‹è¯•é¡µé¢</h1>
    
    <div class="info">
      <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®,AIåŠ©æ‰‹ä¼šæ¨¡æ‹Ÿå‘é€åŒ…å«Markdownå’ŒLaTeXçš„æ¶ˆæ¯ã€‚è§‚å¯Ÿæ¸²æŸ“æ•ˆæœã€‚
    </div>

    <div class="test-section">
      <h2>ğŸ“ åŸºç¡€Markdownæµ‹è¯•</h2>
      <button class="test-button" onclick="testBasicMarkdown()">æµ‹è¯•åŸºç¡€æ ¼å¼</button>
      <button class="test-button" onclick="testLists()">æµ‹è¯•åˆ—è¡¨</button>
      <button class="test-button" onclick="testCode()">æµ‹è¯•ä»£ç å—</button>
      <button class="test-button" onclick="testLinks()">æµ‹è¯•é“¾æ¥</button>
    </div>

    <div class="test-section">
      <h2>ğŸ”¢ LaTeXå…¬å¼æµ‹è¯•</h2>
      <button class="test-button" onclick="testInlineFormula()">æµ‹è¯•è¡Œå†…å…¬å¼</button>
      <button class="test-button" onclick="testBlockFormula()">æµ‹è¯•å—çº§å…¬å¼</button>
      <button class="test-button" onclick="testPhysicsFormulas()">æµ‹è¯•ç‰©ç†å…¬å¼</button>
      <button class="test-button" onclick="testComplexFormulas()">æµ‹è¯•å¤æ‚å…¬å¼</button>
      <button class="test-button" onclick="testSubscriptSuperscript()">æµ‹è¯•ä¸Šä¸‹æ ‡</button>
    </div>

    <div class="test-section">
      <h2>ğŸ¯ ç»¼åˆæµ‹è¯•</h2>
      <button class="test-button" onclick="testCombined()">æµ‹è¯•Markdown+LaTeXæ··åˆ</button>
      <button class="test-button" onclick="testPhysicsProblem()">æµ‹è¯•ç‰©ç†é¢˜è§£ç­”</button>
      <button class="test-button" onclick="clearMessages()">æ¸…ç©ºæ¶ˆæ¯</button>
    </div>

    <div class="test-section">
      <h2>ğŸ“‹ æµ‹è¯•æ¶ˆæ¯ç¤ºä¾‹</h2>
      <div class="code-block" id="example-code">
ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æŸ¥çœ‹æµ‹è¯•æ¶ˆæ¯ç¤ºä¾‹...
      </div>
    </div>
  </div>

  <!-- AIåŠ©æ‰‹è„šæœ¬ -->
  <script src="ai-assistant.js"></script>

  <script>
    // æ¨¡æ‹ŸAIåŠ©æ‰‹(ä¸ä½¿ç”¨çœŸå®API)
    class MockAIAssistant {
      async chat(message) {
        return this.mockStream(message);
      }

      async *mockStream(content) {
        // æ¨¡æ‹Ÿæµå¼è¾“å‡º
        for (let char of content) {
          yield char;
          await new Promise(resolve => setTimeout(resolve, 10));
        }
      }
    }

    // åˆ›å»ºmockåŠ©æ‰‹å’ŒUI
    const mockAssistant = new MockAIAssistant();
    const ui = new AIAssistantUI(mockAssistant, {
      avatarImage: 'ğŸ§ª',
      assistantName: 'æµ‹è¯•åŠ©æ‰‹',
      placeholder: 'è¿™æ˜¯æµ‹è¯•é¡µé¢,ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•...'
    });

    // è‡ªåŠ¨æ‰“å¼€çª—å£
    ui.toggleWindow();

    // è¾…åŠ©å‡½æ•°:å‘é€æµ‹è¯•æ¶ˆæ¯
    async function sendTestMessage(content, exampleCode) {
      document.getElementById('example-code').textContent = exampleCode || content;
      
      // æ¨¡æ‹ŸAIå›å¤
      const messageDiv = ui.addMessage('', 'assistant');
      const contentDiv = messageDiv.querySelector('.ai-message-content');

      let fullContent = '';
      for (let char of content) {
        fullContent += char;
        ui.renderContent(contentDiv, fullContent);
        ui.scrollToBottom();
        await new Promise(resolve => setTimeout(resolve, 10));
      }
    }

    // æµ‹è¯•å‡½æ•°
    function testBasicMarkdown() {
      const content = `è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ–‡æœ¬ã€‚

**ç²—ä½“æ–‡æœ¬** å’Œ *æ–œä½“æ–‡æœ¬*

## äºŒçº§æ ‡é¢˜
### ä¸‰çº§æ ‡é¢˜

è¿™æ˜¯ä¸€ä¸ªæ®µè½,åŒ…å«**ç²—ä½“**ã€*æ–œä½“*å’Œ\`è¡Œå†…ä»£ç \`ã€‚`;
      sendTestMessage(content);
    }

    function testLists() {
      const content = `## æ— åºåˆ—è¡¨
- ç¬¬ä¸€é¡¹
- ç¬¬äºŒé¡¹
- ç¬¬ä¸‰é¡¹

## æœ‰åºåˆ—è¡¨
1. æ­¥éª¤ä¸€
2. æ­¥éª¤äºŒ
3. æ­¥éª¤ä¸‰`;
      sendTestMessage(content);
    }

    function testCode() {
      const content = `## Pythonä»£ç ç¤ºä¾‹

\`\`\`python
def calculate_velocity(distance, time):
    velocity = distance / time
    return velocity

# è®¡ç®—é€Ÿåº¦
v = calculate_velocity(100, 10)
print(f"é€Ÿåº¦: {v} m/s")
\`\`\`

è¿™æ˜¯\`è¡Œå†…ä»£ç \`çš„ç¤ºä¾‹ã€‚`;
      sendTestMessage(content);
    }

    function testLinks() {
      const content = `æŸ¥çœ‹æ›´å¤šä¿¡æ¯:
- [ç‰©ç†å…¬å¼å¤§å…¨](https://example.com)
- [ç‰›é¡¿è¿åŠ¨å®šå¾‹](https://example.com)`;
      sendTestMessage(content);
    }

    function testInlineFormula() {
      const content = `æ ¹æ®å…¬å¼ $v = v_0 + at$,å¯ä»¥è®¡ç®—å‡ºç‰©ä½“çš„é€Ÿåº¦ã€‚

è´¨èƒ½æ–¹ç¨‹ $E = mc^2$ æ˜¯ç›¸å¯¹è®ºçš„æ ¸å¿ƒå…¬å¼ã€‚

åœ†çš„é¢ç§¯å…¬å¼æ˜¯ $A = \\pi r^2$ã€‚`;
      sendTestMessage(content);
    }

    function testBlockFormula() {
      const content = `## ç‰›é¡¿ç¬¬äºŒå®šå¾‹

$$F = ma$$

å…¶ä¸­:
- $F$ æ˜¯åˆå¤–åŠ›
- $m$ æ˜¯ç‰©ä½“è´¨é‡
- $a$ æ˜¯åŠ é€Ÿåº¦`;
      sendTestMessage(content);
    }

    function testPhysicsFormulas() {
      const content = `## å¸¸ç”¨ç‰©ç†å…¬å¼

**1. åŒ€å˜é€Ÿç›´çº¿è¿åŠ¨**

é€Ÿåº¦å…¬å¼: $v = v_0 + at$

ä½ç§»å…¬å¼: $s = v_0 t + \\frac{1}{2}at^2$

é€Ÿåº¦ä½ç§»å…³ç³»: $v^2 - v_0^2 = 2as$

**2. è‡ªç”±è½ä½“**

é«˜åº¦: $h = \\frac{1}{2}gt^2$

é€Ÿåº¦: $v = gt$

è§£å¾—æ—¶é—´: $t = \\sqrt{\\frac{2h}{g}}$

**3. åŠ¨èƒ½å®šç†**

$$W = \\Delta E_k = \\frac{1}{2}mv^2 - \\frac{1}{2}mv_0^2$$

**4. ä¸‡æœ‰å¼•åŠ›å®šå¾‹**

$$F = G\\frac{m_1 m_2}{r^2}$$`;
      sendTestMessage(content);
    }

    function testComplexFormulas() {
      const content = `## å¤æ‚æ•°å­¦å…¬å¼

**æ±‚å’Œå…¬å¼:**

$$\\sum_{i=1}^{n} i = \\frac{n(n+1)}{2}$$

**ç§¯åˆ†:**

$$\\int_{a}^{b} f(x)dx$$

**çŸ©é˜µ:**

$$\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$$

**å¸Œè…Šå­—æ¯:**

$\\alpha, \\beta, \\gamma, \\Delta, \\theta, \\lambda, \\omega$`;
      sendTestMessage(content);
    }

    function testSubscriptSuperscript() {
      const content = `## ä¸Šæ ‡å’Œä¸‹æ ‡æµ‹è¯•

**æ°´å¹³æ–¹å‘:** $x = v_0 t$

**ç«–ç›´æ–¹å‘:** $h = \\frac{1}{2}gt^2$

**åˆé€Ÿåº¦:** $v_0 = 10 m/s$

**å¹³æ–¹:** $v^2 - v_0^2 = 2as$

**ç«‹æ–¹:** $x^3 + y^3 = z^3$

**å¤æ‚ä¸Šä¸‹æ ‡:** $x_1^2 + x_2^2 = r^2$

**åˆ†æ•°ä¸­çš„ä¸Šæ ‡:** 

$$E = \\frac{1}{2}mv^2$$

$$s = v_0t + \\frac{1}{2}at^2$$

**å¤šé‡ä¸Šæ ‡:**

$$e^{-\\frac{x^2}{2}}$$`;
      sendTestMessage(content);
    }

    function testCombined() {
      const content = `## è‡ªç”±è½ä½“è¿åŠ¨åˆ†æ

### å®šä¹‰
è‡ªç”±è½ä½“è¿åŠ¨æ˜¯æŒ‡**ç‰©ä½“åªåœ¨é‡åŠ›ä½œç”¨ä¸‹**ä»é™æ­¢å¼€å§‹ä¸‹è½çš„è¿åŠ¨ã€‚

### å…¬å¼æ¨å¯¼

åˆé€Ÿåº¦ $v_0 = 0$,åŠ é€Ÿåº¦ $a = g$

æ ¹æ®é€Ÿåº¦å…¬å¼:
$$v = gt$$

æ ¹æ®ä½ç§»å…¬å¼:
$$h = \\frac{1}{2}gt^2$$

### ä»£ç å®ç°

\`\`\`python
def free_fall(g, t):
    v = g * t
    h = 0.5 * g * t**2
    return v, h
\`\`\`

### æ³¨æ„äº‹é¡¹
- å¿½ç•¥ç©ºæ°”é˜»åŠ›
- é‡åŠ›åŠ é€Ÿåº¦ $g \\approx 9.8 m/s^2$
- é€‚ç”¨äºè¿‘åœ°è¡¨`;
      sendTestMessage(content);
    }

    function testPhysicsProblem() {
      const content = `## ã€ä¾‹é¢˜ã€‘å¹³æŠ›è¿åŠ¨

### é¢˜ç›®
ä¸€ç‰©ä½“ä»é«˜åº¦ $h = 20m$ å¤„ä»¥åˆé€Ÿåº¦ $v_0 = 10m/s$ æ°´å¹³æŠ›å‡º,æ±‚:
1. ç‰©ä½“åœ¨ç©ºä¸­çš„é£è¡Œæ—¶é—´
2. ç‰©ä½“çš„æ°´å¹³å°„ç¨‹

### è§£ç­”

**æ­¥éª¤1: æ±‚é£è¡Œæ—¶é—´**

ç«–ç›´æ–¹å‘åšè‡ªç”±è½ä½“è¿åŠ¨:
$$h = \\frac{1}{2}gt^2$$

è§£å¾—:
$$t = \\sqrt{\\frac{2h}{g}} = \\sqrt{\\frac{2 \\times 20}{10}} = 2s$$

**æ­¥éª¤2: æ±‚æ°´å¹³å°„ç¨‹**

æ°´å¹³æ–¹å‘åšåŒ€é€Ÿç›´çº¿è¿åŠ¨:
$$x = v_0 t = 10 \\times 2 = 20m$$

### ç­”æ¡ˆ
- é£è¡Œæ—¶é—´: **2ç§’**
- æ°´å¹³å°„ç¨‹: **20ç±³**

### ç›¸å…³å…¬å¼
\`\`\`
æ°´å¹³: x = vâ‚€t
ç«–ç›´: h = Â½gtÂ²
\`\`\``;
      sendTestMessage(content);
    }

    function clearMessages() {
      const chatContainer = document.getElementById('ai-chat-container');
      chatContainer.innerHTML = `
        <div class="ai-welcome-message">
          <p>ğŸ‘‹ æ¶ˆæ¯å·²æ¸…ç©º</p>
          <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ç»§ç»­æµ‹è¯•~</p>
        </div>
      `;
      document.getElementById('example-code').textContent = 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æŸ¥çœ‹æµ‹è¯•æ¶ˆæ¯ç¤ºä¾‹...';
    }
  </script>
</body>
</html>
